🚀 Starting training on device: mps for 50 epochs
Training: 100%|██████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.39epoch/s, batch_max_reward=354, best_reward=385, loss=1.26]


🏁 Training finished
✨ Best reward: 384.59375
🧩 Best sequence: [0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
-------------
384.59375
384.59375
177.0
177.0
-------------
[0 1 1 1 1 0 0 1 0 0 0 0 0 0 1]
[0. 0. 1. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0. 1.]
-------------
[0.         0.         3.21875    8.15625    6.3671875  6.91015625
 8.7265625  8.546875   7.48046875 7.63671875 7.15234375 9.6484375
 7.0234375  8.5625     9.1171875 ]
[19. 95. 70. 74. 72. 17. 20. 51. 16. 18. 19. 28. 30. 18. 58.]
Iteration 1 → Master: 177.000000, Follower(seq): 384.593750, Gap: +207.593750
→ Adding new constraint from follower.
🚀 Starting training on device: mps for 50 epochs
Training: 100%|██████████████████████████████████████████████████████████████████████████| 50/50 [00:03<00:00, 12.66epoch/s, batch_max_reward=307, best_reward=377, loss=1.13]


🏁 Training finished
✨ Best reward: 377.09375
🧩 Best sequence: [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
-------------
377.09375
377.09375
403.0
403.0
-------------
[1 1 1 1 1 0 0 1 0 0 0 0 1 0 0]
[1. 1. 1. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
-------------
[0.         3.8125     0.         8.15625    6.3671875  6.91015625
 8.7265625  8.546875   7.48046875 7.63671875 7.15234375 9.6484375
 7.0234375  8.5625     9.1171875 ]
[19. 95. 70. 74. 72. 17. 20. 51. 16. 18. 19. 28. 30. 18. 58.]
Iteration 2 → Master: 403.000000, Follower(seq): 377.093750, Gap: -25.906250
🚀 Starting training on device: mps for 50 epochs
Training: 100%|██████████████████████████████████████████████████████████████████████████| 50/50 [00:03<00:00, 13.68epoch/s, batch_max_reward=346, best_reward=384, loss=4.14]


🏁 Training finished
✨ Best reward: 384.0
🧩 Best sequence: [0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
-------------
384.0
384.0
403.0
403.0
-------------
[0 1 1 1 1 0 0 1 0 0 0 0 0 0 1]
[1. 1. 1. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
-------------
[0.         3.8125     0.         8.15625    6.3671875  6.91015625
 8.7265625  8.546875   7.48046875 7.63671875 7.15234375 9.6484375
 7.0234375  8.5625     9.1171875 ]
[19. 95. 70. 74. 72. 17. 20. 51. 16. 18. 19. 28. 30. 18. 58.]
Iteration 3 → Master: 403.000000, Follower(seq): 384.000000, Gap: -19.000000
🚀 Starting training on device: mps for 50 epochs
Training: 100%|██████████████████████████████████████████████████████████████████████████| 50/50 [00:03<00:00, 12.91epoch/s, batch_max_reward=346, best_reward=403, loss=1.03]


🏁 Training finished
✨ Best reward: 403.0
🧩 Best sequence: [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
-------------
403.0
403.0
403.0
403.0
-------------
[1 1 1 1 1 0 0 1 0 0 0 0 0 0 1]
[1. 1. 1. 1. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]
-------------
[0.         3.8125     0.         8.15625    6.3671875  6.91015625
 8.7265625  8.546875   7.48046875 7.63671875 7.15234375 9.6484375
 7.0234375  8.5625     9.1171875 ]
[19. 95. 70. 74. 72. 17. 20. 51. 16. 18. 19. 28. 30. 18. 58.]
Iteration 4 → Master: 403.000000, Follower(seq): 403.000000, Gap: +0.000000
→ Convergence reached (follower == master within tolerance).
Traceback (most recent call last):
  File "/Users/arthur/Library/Mobile Documents/com~apple~CloudDocs/Cours/ECN6338/Devoir à rendre/projet Avec critique/train.py", line 328, in <module>
    f"master_val={master_val:.4f}, follower_val={follower_val:.4f}, iterations={n_iter}")
                  ^^^^^^^^^^
NameError: name 'master_val' is not defined
